---
title: 计算机网络原理之【拥塞控制】
categories:
- 网络原理
tags:
- 网络原理
---

计算机网络原理之拥塞控制。

<!--more-->



### 一、什么是拥塞控制？

**拥塞控制**是一种用来调整传输控制协议（TCP）连接单次发送的分组数量的算法。它通过增减单次发送量逐步调整，使之逼近当前网络的承载量。



### 二、为什么进行拥塞控制？

发送端给接收端发送数据，如果接收端没有接收到数据就不会进行应答，从而发送端认为是数据包丢失了，所以重新进行发送。其实接收端接收不到数据包分为两种情况：

- 数据包真的丢失了。
- 网路通信拥挤，正在排队等待，处于拥挤状态。

> 其实我们相对于第二种来提出拥塞控制算法的。如果这样一直拥塞，发送端一直发送数据，白白浪费掉了网络资源，网络通信更加阻塞。



### 二、如何知道网络拥塞情况？

> 只有我们想办法知道网络的拥塞情况，才可以进行拥塞控制。



#### 2.1 什么是拥塞窗口

> 发送端一次性能够连续发送的数据包的多少，称为拥塞窗口。



#### 2.2 探测网络情况

> 通过两种策略，都是通过向网络中发送多个数据包来测试，到达一定的程度，就会阻塞。



##### 1、策略一：逐渐增长

连续递增发送。第一次发送一个数据包，第二次发送两个.... 逐渐网上加。



##### 2、策略二：指数增长

策略一这样检测太慢，而策略二采取成倍方式递增。（指数增长，可能还没增长几次，就到瓶颈期了）



##### 3、策略三：结合使用

策略三就是将策略一和策略二结合起来使用，前期使用策略二，让它快速增长，我们设定一个值，叫做阀值（ssthresh），到达阀值的时候就采用第一种策略增长，缓慢增长，这样更好的找到拥塞点。



#### 3.3 慢启动和拥塞避免

- 指数增长阶段称为**慢启动**。
- 线性增长称之为**拥塞避免**。



### 三、传输阻塞超时

当数据包增长到一定程度就会出现超时事件（瓶颈期），出现超时事件就认为网络拥塞了，不能再继续增长了，此时标记为 MAX。



#### 3.1 超时怎么办？

发送一定的数据包出现超时情况，此时我们应该把阀值（ssthresh）减少为超时时的一半量（最大值 MAX/2 ）



#### 3.2 超时不一定是阻塞

我们上边说过，超时有两种情况，第一种是网络阻塞，第二种是数据包丢失或损坏导致的超时。如何处理判断这种情况？



#### 3.3 判断超时的情况

> 一般解决方法是通过**冗余ACK** 来处理。因为数据包的发送是由序列的，每发送一个数据包，就会返回一个确认值，如果连续发送 A1、A2、A3就会收到确认信息a1、a2、a3。如果没有收到的话，就可能丢失了。

![img](https://mmbiz.qpic.cn/mmbiz_png/gsQM61GSzINfuKCKn8IwibwelDSLQibRCtukuqbPb3U4namqva9qjgVhU7qfXOP2ZpGZSJzxgaZHKVbwCUic1UODQ/640?tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

当发送端连续收到三个确认 M2 的时候，且 M3 超时事件还没发生，发送端就知道 M3 数据包丢失了。A 就不必等待 M3 设置的计时器到期了，而是**快速重传** M3，并把窗口设置为最大值MAX 的一半，然后慢慢的进行线性增长。（另外TCP版本，无论是超时还是接收到三个 ACK 确认，都把窗口设置为 1 ）

> 我们也把这种情况称之为**快速恢复**。而这种具有快速恢复的TCP版本称之为TCP Reno。

















































