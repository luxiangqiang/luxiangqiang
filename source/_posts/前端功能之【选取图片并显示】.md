---
title: 前端功能之【选取图片并显示】
categories:
- 前端功能实现
tags:
- 前端功能实现
---

本地选取图片并显示！

<!--more-->



### 一、选取本地图片

#### 1、HTML

###### ▉ accept 属性

> 控制选取照片的类型。

```
// 建议只选择照片使用这种写法
accept="image/png, image/jpeg, image/gif, image/jpg"
// 其次这种写法
accept="image/*"
```



###### ▉ multiple 属性

> 用来选择多个文件上传。



###### ▉ 改变样式

> 通过使用 `lable`  `for` 的联动改变上传按钮的样式。
>
> 1）`input` 需要设置 `display:none` 属性进行隐藏。
>
> 2）然后通过 `lable` 的 `for` 的值为` input` 的` ID` 属性值。



###### ▉ 实例

```html
// input 选取
<input id="user_icon" type="file" accept="image/*" onchange="preImg(this.id,'image_icon',this)" style="display: none" />
// 按钮
<button id="choose_icon">选择照片</button>
// 显示图片
<img id="image_icon" width="138" height="150">
```



#### 2、javascript

###### ▉ 限制照片大小

```javascript
// 添加内容：图片大小限制
function  limitFileSize(sourceId){
    //图片大小限制
    var fileSize = 0;
    var fileMaxSize = 1024;//1024k
    // 通过 input ID 获取到图片的大小
    fileSize = document.getElementById(sourceId).files.item(0).size;
    var size = fileSize / 1024; //转换成 KB
    if(size >= fileMaxSize){
        alert("文件大小不能大于 1 M！");
        return false;
    }else if(size <= 0){
        alert("文件大小不能小于 0 M！");
        return false;
    }
    return true;
}
```



###### ▉ 显示图片

```javascript
//显示图片
// sourceId: ipnput id,sourceId: image id file: input object
function preImg(sourceId, targetId,file) {
    var url = getFileUrl(sourceId);
    var imgPre = document.getElementById(targetId);
    // 获取到的图片本地 url 设置 img 的 src 属性就 ok 了
    imgPre.src = url;
}
```



###### ▉ 判断浏览器类型

> 不同的浏览器，选取图片 URL 的路径方式不相同。
>
> 1） 照片的路径就是 input 的 value 的值
>
> 2）选择 url 之前，要判断图片的大小。

```javascript
// 选择图片按钮监听
$("#choose_icon").click(function () {
    $("#user_icon").click();
});

// 选取本地文件
function getFileUrl(sourceId) {
    var url;
    if (navigator.userAgent.indexOf("MSIE")>=1) { // IE
        //限制文件大小
        if(limitFileSize(sourceId)){
            // 照片的路径就是 input 的 value 的值
            url = document.getElementById(sourceId).value;
        }else{
            return;
        } 
    } else if(navigator.userAgent.indexOf("Firefox")>0) { // Firefox
        //限制文件大小
        if(limitFileSize(sourceId)){
            url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
        }else{
            return;
        } 
    } else if(navigator.userAgent.indexOf("Chrome")>0) { // Chrome
        //限制文件大小
        if(limitFileSize(sourceId)){
            url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0)); 
        }else{
            return;
        }  
    }
    return url;
}
```



### 二、上传本地图片

> `enctype` 属性规定在发送到服务器之前应该如何对表单数据进行编码，默认的编码是：” `application/x-www-form-urlencoded` “。对于普通数据是挺适用的，对于文件，就不能乱编码了，该什么就是什么，只能使用 `multipart/form-data` 作为 `enctype` 属性值。 









