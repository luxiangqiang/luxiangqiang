---
title: 数据结构与算法之美【红黑树】
categories:
- 数据结构
- tree
tags:
- 数据结构
- tree
password: 小鹿
---

为什么工程中都用红黑树这种二叉树！

<!--more-->



## 红黑树(上)

### 一、什么是平衡二叉树

> 二叉树中任意一个节点的**左右子树**的高度相差不能大于 1。最早出现的平衡二叉树是 AVL 树。（完全二叉树、满二叉树，AVL树）

![](/images/平衡二叉树.png)



### 二、红黑树

![](/images/红黑树实例.png)



#### 1、红黑树的由来

> 为了解决普通二叉查找树在数据更新的过程中，复杂度退化的问题而产生的。



#### 2、红黑树（Red-Black Tree）

> 顾名思义，红黑树中的节点，一类被标记为黑色，一类被标记为红色。红黑树，简称 R-B Tree。它是一种不严格的平衡二叉树。

- **根**节点是**黑色**的；
- 每个**叶子**的结点都是**黑色的空节点**（NIL），叶子节点不存储数据；
- 任何相邻（**上下**）的结点都不能同时为红色，红色结点是被黑色结点隔开的；
- 每个节点，从该节点到其可达叶子节点的所有路径，都包含相同数目的黑色节点；



### 三、红黑树的性能分析

> 『**平衡**』可以等价为性能不退化。『**近似平衡**』就等价为性能不会退化的太严重。



#### 1、怎么判断红黑树平衡？

> 二叉查找树的性能（时间复杂度）跟树的高度成正比，大约是 log2n ，只要分析**「红黑树的高度是否趋近于 log2n 」**。



#### 2、红黑树的复杂度分析

> 红黑树的高度近似 log2n，所以它是近似平衡，插入、删除、查找操作的时间复杂度都是 O(logn)。

![](/images/红黑树分析性能.png)

##### ■ 分析

1、先将红色结点去掉，单纯的看黑色节点的高度.

2、由上图可知，红黑树变成了四叉树。

3、仅包含黑色节点的四叉树高度比包含相同节点的二叉树高度要小，完全二叉树的高度近似log2n，去掉红色结点的红黑树也就是小于 log2n。

4、因为红黑树红黑结点相隔，加入红色节点之后，红黑树的高度近似 **2log2n**。

> **补充：**红黑树的高度只比高度平衡的 AVL 树的高度（log2n）仅仅大了一倍，在性能上，下降得并不多。这样推导出来的结果不够精确，实际上红黑树的性能更好。



### 四、为什么喜欢在工程中用红黑树平衡二叉查找树？

> 1、其他平衡而二叉树 **Treap、Splay Tree** 绝大情况下操作效率非常高，但是在**极端情况下**时间复杂度会退化，这种极端情况虽然出现的概率不大，对于单次操作时间非常敏感。
>
> 2、AVL树是一种高度平衡二叉树，查找的效率非常高，但是AVL树为了维持这种高度平衡，**每次插入、删除都要做调整，就比较复杂、耗时**。所以对于比较频繁的插入、删除操作的数据集合，使用AVL树代价比较高。
>
> 3、红黑树虽然只做到了**近似平衡**，并不是严格的平衡，所以在**维护成本**上比AVL树低。
>
> 4、红黑树的插入、删除、查找各种操作**性能都比较稳定**。对于工程应用来说，要面对各种异常情况，为了支撑这种工业级的应用，更倾向于这种性能稳定的平衡二叉查找树。



### 五、扩展思考

#### 1、还有哪些支持动态地数据插入、删除、查找操作的数据结构，各自的优缺点和应用场景怎么样的？

> **答：** 



### 六、联系扩展

#### 1、跳表

> 红黑树实现比较复杂，更倾向用跳表来代替。



















