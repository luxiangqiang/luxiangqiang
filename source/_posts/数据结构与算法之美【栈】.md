---
title: 数据结构与算法之美【栈】
categories:
- 数据结构
tags:
- 数据结构
password: 小鹿
---

如何实现浏览器的前进后退功能？

<!--more-->



### 一、栈的基本常识

#### 1、什么是栈？

> 先进后出的结构。



#### 2、特点

> 先进后出。



### 二、怎么实现栈？

> 用数组实现的栈，叫作**顺序栈**，用链表实现的栈，叫作**链式栈**。



#### 1、顺序栈

> 基于数组实现的顺序栈。

```java
package easy_test;

/**
 * 功能:基于数组的顺序栈
 * @author:小鹿
 *
 */
public class ArrayStack {
	
   private String[] items;  // 数组
   private int count;       // 栈中元素个数
   private int n;           // 栈的大小

   // 初始化数组，申请一个大小为 n 的数组空间
   public ArrayStack(int n) {
     this.items = new String[n];
     this.n = n;
     this.count = 0;
   }
 
   /**
    * 功能:入栈
    * 说明:数组入栈的入口为数组尾部
    * @param item :入栈数据元素
    * @return:是否入栈成功
    */
   public boolean push(String item) {
     // 数组空间不够了，直接返回 false，入栈失败。
     if (count == n) return false;
     // 将 item 放到下标为 count 的位置
     items[count] = item;
     //数组长度+1
     ++count;
     //入栈成功
     return true;
   }
  
   /**
    * 功能:出栈
    * @return:返回出栈元素
    */
   public String pop() {
     // 栈为空，则直接返回 null
     if (count == 0) return null;
     // 返回下标为 count-1 的数组元素
     String tmp = items[count-1];
     //数组长度-1
     --count;
     //返回出栈数据元素
     return tmp;
   }
}
```



#### 2、链式栈

> 基于链表实现的链式栈。

```java
package easy_test;

/**
 * 功能:基本链表实现栈，入栈、出栈、输出栈
 * @author : 小鹿
 *
 */
public class StackBasedLinkedList {
	//定义栈顶指针
	private Node top = null;
	
	//定义栈结点
	private static class Node {
		//栈结点数据域
	    private int data;
	    //栈结点指针域
	    private Node next;
	    //构造函数
	    public Node(int data, Node next) {
	      this.data = data;
	      this.next = next;
	    }
	    //get 获取数据域方法
	    public int getData() {
	      return data;
	    }
	}
	
	/**
	 * 功能:入栈
	 * @param value:要入栈的数据元素
	 */
	public void push(int value) {
		//创建一个栈结点 
	    Node newNode = new Node(value, null);
	    // 判断栈是否为空
	    if (top == null) {
	      //如果栈为空，就将入栈的值作为栈的第一个元素
	      top = newNode;
	    } else {
	      //否则插入到top栈结点前（所谓的就是单链表的头插法）
	      newNode.next = top;
	      top = newNode;
	    }
	}
	
	/**
	 * 功能 : 出栈
	 * @return: -1 为栈中没有数据
	 */
	public int pop() {
		// 如果栈的最顶层栈结点为null,栈为空
	    if (top == null) return -1;
	    
	    //否则执行出栈操作，现将栈顶结点的数据元素赋值给 Value
	    int value = top.data;
	    //将 top 指针向下移动
	    top = top.next;
	    //返回出栈的值
	    return value;
	}	
	
	/**
	 * 功能:输出栈中所有元素
	 */
	public void printAll() {
		//将栈顶指针赋值给p
	    Node p = top;
	    //循环遍历栈(遍历单链表)
	    while (p != null) {
	      System.out.print(p.data + " ");
	      //指向下一个结点
	      p = p.next;
	    }
	    System.out.println();
	}
}
```





### 三、栈操作的性能

#### 1、时间复杂度

> 顺序栈和链式栈入栈和出栈只操作栈顶元素，所以时间复杂度为 O(1)。



#### 2、空间复杂度

> 顺序栈和链式栈只需要大小为 n 的空间就可以，入栈和出栈需要一个临时空间来存储变量，空间复杂度为 O(1)。



#### 3、栈的动态扩容

> 当栈满的时候，需要进行动态扩容，可以仿照数组的动态扩容。
>
> 1）出栈涉及不到扩容，时间复杂度为 O(1)；入栈当栈满的时候，需要进行扩容，数据进行搬移，时间复杂度为 O(n)。平均时间复杂度为 O(1)，进行摊还分析。



### 五、栈的实际应用

> 栈在解决实际问题中起着关键的作用。

- **LeedCode 第 20 题：**[有效的括号（简单）](https://github.com/luxiangqiang/JS-LeetCode/blob/master/ValidParentheses.md)
- **LeedCode 第 32 题：**[最长有效括号（困难）](https://github.com/luxiangqiang/JS-LeetCode/blob/master/LongestVaildParentheses.md )



#### 1、应用一：函数调用栈

> 操作系统给每个线程分配了一块独立的内存空间，这块内存被组织成“栈”这种结构, 用来存储函数调用时的临时变量。每进入一个函数，就会将临时变量作为一个栈帧入栈，当被调用函数执行完成，返回之后，将这个函数对应的栈帧出栈。



###### ▉ 代码实现

```java
int main() {
   int a = 1; 
   int ret = 0;
   int res = 0;
   ret = add(3, 5);
   res = a + ret;
   printf("%d", res);
   reuturn 0;
}

int add(int x, int y) {
   int sum = 0;
   sum = x + y;
   return sum;
}
```



######  ▉ 代码实现

![](/images/函数调用入栈.png)



#### 2、应用二：栈在表达式求值中的应用

> 编译器就是通过两个栈来实现的。其中一个**保存操作数的栈 **，另一个是**保存运算符的栈**。从左向右遍历表达式，**当遇到数字，我们就直接压入操作数栈；当遇到运算符，就与运算符栈的栈顶元素进行比较**。



###### ▉ 问题

> 将 `3+5*8-6` 这个表达式的计算过程画成了一张图，进行计算。



###### ▉ 图示

![](/images/表达式求值.png)

###### ▉ 分析

> 如果比运算符栈顶元素的优先级高，就将当前运算符压入栈；**如果比运算符栈顶元素的优先级低或者相同，从运算符栈中取栈顶运算符，从操作数栈的栈顶取 2 个操作数，然后进行计算，再把计算完的结果压入操作数栈**，继续比较。



#### 3、应用三：栈在括号匹配中的应用

> 用栈来保存未匹配的左括号，从左到右依次扫描字符串。当扫描到左括号时，则将其压入栈中；当扫描到右括号时，从栈顶取出一个左括号。如果能够匹配，比如“(” 跟 “)”匹配，“[”跟“]”匹配，“{”跟“}”匹配，则继续扫描剩下的字符串。如果扫描的过程中，遇到不能配对的右括号，或者栈中没有数据，则说明为非法格式。 



### 六、本节思考：怎样实现浏览器的前进后退？

> **答：**使用两个栈，X 和 Y，把首次浏览的页面依次压入栈 X，当点击后退按钮时，再依次从栈 X 中出栈，并将出栈的数据依次放入栈 Y。当我们点击前进按钮时，依次从栈 Y 中取出数据，放入栈 X 中。当栈 X 中没有数据时，那就说明没有页面可以继续后退浏览了。当栈 Y 中没有数据，那就说明没有页面可以点击前进按钮浏览了。 



### 七、扩展思考

#### 1、为什么函数调用要用“栈”来保存临时变量呢？用其他数据结构不行吗？

> **答：** 
>
> 1）因为函数调用的执行顺序符合**后进者先出，先进者后出**的特点。比如函数中的局部变量的生命周期的长短是先定义的生命周期长，后定义的生命周期短；还有函数中调用函数也是这样，先开始执行的函数只有等到内部调用的其他函数执行完毕，该函数才能执行结束。
> 2）正是由于函数调用的这些特点，根据数据结构是特定应用场景的抽象的原则，优先考虑栈结构。



#### 2、那 JVM 里面的“栈”跟我们这里说的“栈”是不是一回事呢？如果不是，那它为什么又叫作“栈”呢？

> **答：** JVM里面的栈和我们这里说的是一回事，被称为方法栈。和前面函数调用的作用是一致的，用来存储方法中的局部变量。



### 八、栈的掌握程度

#### 1、用数组实现一个顺序栈。

#### 2、用链表实现一个链式栈。

#### 3、编程模拟实现一个浏览器的前进、后退功能。



